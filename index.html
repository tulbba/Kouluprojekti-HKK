<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<title>Helsingin Kirpputorit Kartalla</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link
rel="stylesheet"
href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
crossorigin=""
/>
<script
src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
crossorigin=""
></script>
<link rel="stylesheet" href="./styles.css" />
<link rel="stylesheet" href="node_modules/leaflet-search/src/leaflet-search.css" />
<link rel="preconnect" href="https://fonts.gstatic.com" />
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
<link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="css/styles.css" />

</head>


<header>
	<h1>Helsingin</h1>
	<h1 class="kirppari">Kirpparit</h1>

    <div class="container-fluid py-3"></div>

	
    <nav class="navbar navbar-expand-lg navbar navbar-dark bg-dark">
        <div class="container-fluid">
			<a class="navbar-brand" href="#">Helsingin kirpparit</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav w-100 justify-content-between">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">Etusivu</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Tietoa meistä</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

</header>




<body>

<div id="map"></div>


<!--<div id="post-it">
<b>Kirpputorit:</b><br />
</div>-->

<script src="https://unpkg.com/jquery@3.3.1/dist/jquery.js"></script>
<script src="https://unpkg.com/leaflet@1.3.0/dist/leaflet.js"></script>
<script src="node_modules/leaflet-search/src/leaflet-search.js"></script>
<!--
<script src="/hkk-haku-ville/node_modules/map.js"></script> -->


<script>
    var data = [
  {"loc":[60.20266957854647, 24.96800381015687], "title":"UFF Second Hand (Kauppakeskus Arabia), Hämeentie 111", "summary":"<b>UFF Second Hand (Kauppakeskus Arabia)</b><br>Hämeentie 111<br>ma-pe 10-20, la 10-18, su 12-18</br>"},
  {"loc":[60.16345848887299, 24.934771503859576], "title":"UFF Second Hand, Bulevardi 30", "summary":"<b>UFF Second Hand</b><br>Bulevardi 30<br>ma-pe 10-20, la 10-18, su 12-18</br>"},
  {"loc":[60.1893749, 24.9165526], "title":"UFF Second Hand, Mannerheimintie 104", "summary":"<b>UFF Second Hand</b><br>Mannerheimintie 104<br>ma-pe 10-20, la 10-18, su 12-18</br>"}
];

var mymap = new L.Map("map", {zoom: 12, center: new L.latLng(data[0].loc)});
mymap.zoomControl.setPosition('topright'); //Siirtää zoom controllit kartan oikeaan yläkulmaan 

mymap.addLayer(new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')); //Lisätään kartan pohja layer

var markersLayer = new L.LayerGroup(); //Layer sisältää haetut elementit
mymap.addLayer(markersLayer); //Lisätään markersLayer kartalle

//Luodaan uusi haku control ja annetaan sille asetuksia
var controlSearch = new L.Control.Search({
    layer: markersLayer, 
    initial: false, //antaa hakuun sopivia tuloksia kirjaimen esiintyessä missä tahansa kohtaa
    position:'topleft', //haku sijoitettu vasempaan yläkulmaan, default oikealla
    collapsed: true, //hakukenttä sulkeutuu haun suorittamisen jälkeen
    autoCollapse: true, //hakutulokset ja error message sulkeutuvat automaattisesti
    autoCollapseTime: 10000, //aika ennen hakutulosten/error messagen sulkeutumista
    textPlaceholder: 'Hae osoitteella tai nimellä...', //hakukentän placeholder
    tipAutoSubmit: true,
    textErr: 'Antamallasi haulla ei löytynyt yhtään kirpparia :(', //error message
    zoom: 16, //zoomlevel haun toteuduttua, esim. zoomaa lähemmäs haun löytämää lokaatiota
    marker: {						
			icon: false, //kustomoitu L.Marker, poistettu
            circle: {	//ympyröi valitun lokaation, poistettu
				stroke: false,
				fill: false
			}
    }
    
}); 

mymap.addControl( controlSearch ); //Lisää hakukentän kartalle

//Luodaan markerit ja popupit kirppareille, joiden tiedot haetaan markersLayerista joka haki ne data -muuttujasta
for(i in data) {
  var title = data[i].title, //kirpparin nimi löydetty datasta (title)
    summary = data[i].summary, //popupin tiedot löydetty datasta (summary)
      loc = data[i].loc, //kirpparin lokaatio löydetty datasta (loc)
      marker = new L.Marker(new L.latLng(loc), {title: title});
  marker.bindPopup(summary); //lisää popupin markeriin kirpparin tiedoilla (title)
  markersLayer.addLayer(marker); //lisää layerin joka sisältää markerit
}

require(["leaflet", "leafletSearch"],function(L, LeafletSearch) {

//... initialize leaflet map and dataLayer ...

mymap.addControl( new LeafletSearch({
    layer: dataLayer
}) );
}); 
</script>


</body>
</html>
